<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>埼玉県 AED 設置状況マップ</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4bM3zCB2mprL2zY6k9P06laC2rooa7hCtmQKq1rCkE="
      crossorigin="anonymous"
    >
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"
    >
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"
    >
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <header class="hero">
      <div>
        <p class="eyebrow">埼玉県オープンデータ（AED設置施設）</p>
        <h1>市区町村別に見る AED 設置状況</h1>
        <p>
          県が公開している AED 設置地点（13,000 件超）を地図とグラフで可視化しました。
          市区町村やキーワードで絞り込み、近隣の設置場所を素早く探せます。
        </p>
      </div>
      <div class="hero-meta">
        <a
          href="https://www.arcgis.com/home/item.html?id=63cb7f3658e34b46b70e65d47d606f10"
          target="_blank"
          rel="noreferrer"
        >データソースを見る ↗</a>
        <span>最終更新: 県公開データに準拠</span>
      </div>
    </header>

    <main class="layout">
      <section class="map-panel">
        <div class="map-controls">
          <label for="citySelect">市区町村フィルタ</label>
          <select id="citySelect">
            <option value="all">全ての市区町村</option>
          </select>
          <label for="searchInput">キーワード検索</label>
          <input
            id="searchInput"
            type="search"
            placeholder="施設名・住所・設置場所など"
            autocomplete="off"
          >
          <p class="hint">選択・検索内容に応じて地図とリストが同期します。</p>
        </div>
        <div id="map" aria-label="AED設置場所の地図"></div>
      </section>

      <section class="insights">
        <div class="stat-cards">
          <article>
            <p class="stat-label">掲載 AED 数</p>
            <p class="stat-value" id="totalCount">-</p>
          </article>
          <article>
            <p class="stat-label">市区町村数</p>
            <p class="stat-value" id="cityCount">-</p>
          </article>
          <article>
            <p class="stat-label">フィルタ後の件数</p>
            <p class="stat-value" id="filteredCount">-</p>
          </article>
        </div>

        <div class="chart-card">
          <div class="card-header">
            <h2>市区町村別 AED 設置数（上位 20）</h2>
            <p>棒グラフをクリックすると該当自治体へフォーカスします。</p>
          </div>
          <canvas id="cityChart" aria-label="市区町村別 AED 設置数"></canvas>
        </div>

        <div class="table-card">
          <div class="card-header">
            <h2>ヒットした設置場所（最大 30 件）</h2>
            <p id="listSummary">-</p>
          </div>
          <ol id="resultList" class="result-list"></ol>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <p>
        データ: <a href="https://www.arcgis.com/home/item.html?id=63cb7f3658e34b46b70e65d47d606f10" target="_blank" rel="noreferrer">埼玉県 AED 設置施設（ArcGIS Hub）</a>。
        出典である <a href="https://opendata.pref.saitama.lg.jp/" target="_blank" rel="noreferrer">埼玉県オープンデータポータル</a> の公開形式に基づき再編しています。
      </p>
    </footer>

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin="anonymous"
      defer
    ></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js" integrity="sha256-/kHPYsYAGdivgLPgAvFp8Z64Kbjsggq09uXBJgp7wa0=" crossorigin="anonymous" defer></script>
    <script src="main.js" defer></script>
  </body>
</html>
